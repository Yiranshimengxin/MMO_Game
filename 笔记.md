# 游戏中都包括哪些系统

1、Log系统（日志系统），也是文件系统，记录游戏运行期间运行信息（系统信息，位置信息，内存大小等等），运行错误日志

2、系统资源（图片、模型、shader等等）

3、网络系统（使游戏联网，tcp，udp）

4、声音系统

5、video系统（CG）

6、Lua脚本系统

7、Patch系统（更新系统）



游戏开始的时候，会加载资源

游戏运行的时候，更新资源

游戏结束的时候，会释放资源





## 服务器端不止有一个进程：

1、Login登录服务器，负责游戏账号的登录，验证，创建

2、Game游戏服务器，保存，加载游戏角色，好友，排行榜，积分等等

3、聊天服务器，负责聊天

4、战斗服务器，战斗验证

5、匹配服务器

6、数据库服务器

7、数据库



简化版

Game创建角色，保存角色，游戏逻辑，匹配

battle战斗服务器

数据库 mongo



## 实现游戏中完整的日志系统

### 日志系统的重要性

##### 作用：

​	监控玩家状态变化，如账号等级，角色创建，上线下线，充值等；

​	分析玩家行为，主要参与了哪些活动和玩法

​	帮助分析bug，记录玩家的行为和数据变化，可以回溯bug产生的过程

​	方便客服，查询和处理玩家反馈

##### 数据结构

​	文本

​	数据库  MySQL mongoldb

​	日志数据库 

​		Elasticsearch 是一个免费且开放的分布式搜索和分析引擎，适用于包括文本、数字、地理空间、结构化和非结构化数据等在内的所有类型的数据。

​		Logstash 是免费且开放的服务器端数据处理管道，能够从多个来源采集数据，转换数据，然后将数据发送到您最喜欢的“存储库”中。

### 前端日志系统

##### 使用C#编写日志系统，写入到文件中

1.打开或创建文件

2.文件滚动（文件大小限制）

3.删除过期文件

4.日志文件格式化

##### Unity Application介绍

1.Application.dataPath  游戏存放数据的地方

2.Application.persistenDataPath

3.Application.platform  游戏当前运行的平台



## Go语言服务器开发

### 1.Go语言简介

###### 1.Go是编译型语言

Go 使用编译器来编译代码。编译器将源代码编译成二进制（或字节码）格式；在编译代码时，编译器检查错误、优化性能并输出可在不同平台上运行的二进制文件。要创建并运行 Go 程序，程序员必须执行如下步骤。

1. 使用文本编辑器创建 Go 程序；
2. 保存文件；
3. 编译程序；
4. 运行编译得到的可执行文件。

###### 2.语言特性

[Go语言的特性有哪些？ (biancheng.net)](http://c.biancheng.net/view/3990.html)

​	（1）语法简单

​	（2）并发模型

​	（3）内存分配

​	（4）垃圾回收

​	（5）静态链接

​	（6）标准库

​	（7）工具链

### 2.Go环境安装

### 3.基本语法

1.变量

一次声明多个变量的方式一般用在声明全局文件变量

2.数据类型

（1）整数

int8 ,  int16 ,  int32 ,  int64 ,  int
uint8 ,  uint16 ,  uint32 ,  uint64 ,  uint

（2）浮点数

float32 ,  float64

（3）字符串

string

（4）字符

byte

（5）bool 类型

bool

（6）数据类型相互转换

3.指针

（1）指针地址和指针类型

（2）从指针获取指针指向的值

（3）使用指针修改值

（4）new 函数创建指针

4.数据类型转换

​	valueOfTypeB = typeB(valueOfTypeA)

​	类型 B 的值 = 类型 B(类型 A 的值)



5.常量与枚举

（1）const 关键字

（2）iota 关键字

6.运算符

​	下表列出了所有Go语言的算术运算符。假定 A 值为 10， B 值为 20。

![image-20230723182803893](C:\Users\chenzongrui\AppData\Roaming\Typora\typora-user-images\image-20230723182803893.png)

7.类型别名（type 关键字）

8.关键字

9.变量生命周期与逃逸

### 4.容器介绍

1.数组

2.切片

3.集合map

4.范围range

### 5.流程控制

if else（分支结构）

###### 特殊写法

if 还有一种特殊的写法，可以在 if 表达式之前添加一个执行语句，再根据变量值进行判断，代码如下：

```
if err := Connect(); err != nil {    fmt.Println(err)    return}
```

Connect 是一个带有返回值的函数，err:=Connect() 是一个语句，执行 Connect 后，将错误保存到 err 变量中。

err != nil 才是 if 的判断表达式，当 err 不为空时，打印错误并返回。

这种写法可以将返回值与判断放在一行进行处理，而且返回值的作用范围被限制在 if、else 语句组合中。



for（循环结构）

break（跳出循环）

continue（继续下一次循环）



switch case语句

###### 1) 一分支多值

当出现多个 case 要放在一起的时候，可以写成下面这样：

```
var a = "mum"switch a {case "mum", "daddy":    fmt.Println("family")}
```

不同的 case 表达式使用逗号分隔。

###### 2) 分支表达式

case 后不仅仅只是常量，还可以和 if 一样添加表达式，代码如下：

```
var r int = 11switch {case r > 10 && r < 20:    fmt.Println(r)}
```

注意，这种情况的 switch 后面不再需要跟判断变量。



### 6.函数

###### 普通函数声明（定义）

函数声明包括函数名、形式参数列表、返回值列表（可省略）以及函数体。

func 函数名(形式参数列表)(返回值列表){
  函数体
}



### 7.结构体

### 8.接口

### 9.Go语言包

### 10.并发

#### 进程/线程

进程是程序在操作系统中的一次执行过程，系统进行资源分配和调度的一个独立单位。

线程是进程的一个执行实体，是 CPU 调度和分派的基本单位，它是比进程更小的能独立运行的基本单位。

一个进程可以创建和撤销多个线程，同一个进程中的多个线程之间可以并发执行。

#### 并发/并行

多线程程序在单核心的 cpu 上运行，称为并发；多线程程序在多核心的 cpu 上运行，称为并行。

并发与并行并不相同，并发主要由切换时间片来实现“同时”运行，并行则是直接利用多核实现多线程的运行，Go程序可以设置使用核心数，以发挥多核计算机的能力。

#### 协程/线程

协程：独立的栈空间，共享堆空间，调度由用户自己控制，本质上有点类似于用户级线程，这些用户级线程的调度也是自己实现的。

线程：一个线程上可以跑多个协程，协程是轻量级的线程。



#### 互斥锁

另一种同步访问共享资源的方式是使用互斥锁，互斥锁这个名字来自互斥的概念。互斥锁用于在代码上创建一个临界区，保证同一时间只有一个 goroutine 可以执行这个临界代码。

```go
var lock sync.Mutex
var count int = 0

func running(index int) {
    // 构建一个无限循环
    lock.Lock()
    for i := 0; i < 100; i++ {
       count++
    }
    lock.Unlock()

    fmt.Printf("index=%d,count=%d", index, count)
}
```

#### 原子函数

```go
var atomicInt atomic.Int64

func running(index int) {
    // 构建一个无限循环
    lock.Lock()
    for i := 0; i < 100; i++ {
       atomicInt.Add(1)
    }
    lock.Unlock()

    fmt.Printf("index=%d,count=%d", index, atomicInt.Load())
}
```

[C#](http://c.biancheng.net/csharp/)、Lua、[Python](http://c.biancheng.net/python/) 语言都支持 coroutine 特性。coroutine 与 goroutine 在名字上类似，都可以将函数或者语句在独立的环境中运行，但是它们之间有两点不同：

- goroutine 可能发生并行执行；
- 但 coroutine 始终顺序执行。





### 11.反射

### 12.文件处理

### 13.工程管理



## Git介绍

1、Git是什么
​	分布式版本管理系统，分布式版本控制系统根本没有“中央服务器”，每个人的电脑上都是一个完整的版本库

2、Git安装

3、Git分支



# 游戏中的网络系统

游戏中的网络分为：服务器、客户端，服务器和客户端是1比N的关系

网络协议分为udp，tcp，http，https（底层是用tcp协议实现的）

Tcp 在C#封装的实现中，分为同步和异步



# Linux Signal及Golang中的信号处理

信号(Signal)是Linux, 类Unix和其它POSIX兼容的操作系统中用来进程间通讯的一种方式。一个信号就是一个异步的通知，发送给某个进程，或者同进程的某个线程，告诉它们某个事件发生了。
当信号发送到某个进程中时，操作系统会中断该进程的正常流程，并进入相应的信号处理函数执行操作，完成后再回到中断的地方继续执行。
如果目标进程先前注册了某个信号的处理程序(signal handler),则此处理程序会被调用，否则缺省的处理程序被调用。
